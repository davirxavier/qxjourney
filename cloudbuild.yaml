steps:
  - name: gcr.io/cloud-builders/gcloud
    entrypoint: "bash"
    args:
      - "-c"
      - |
        gcloud compute ssh ${_ACCOUNT_NAME}@${_INSTANCE_NAME} --project=$PROJECT_ID --zone=${_VM_REGION} -- 'curl ${_SCRIPT_PATH} > buildqxjourney.sh && chmod +x buildqxjourney.sh && sudo ./buildqxjourney.sh ${_FOLDER} "${_REPO_URL}"'
    id: 'imgs'

  - name: gcr.io/cloud-builders/gcloud
    entrypoint: "bash"
    args:
      - "-c"
      - |
        gcloud compute ssh ${_ACCOUNT_NAME}@${_INSTANCE_NAME} --project=$PROJECT_ID --zone=${_VM_REGION} -- 'cd ${_FOLDER}/scripts && docker compose up -d'
    waitFor: ['imgs']
    
options:
  logging: CLOUD_LOGGING_ONLY
